stages: 
  - prune-remote
  - update-remote

workflow:
  rules:
    - if: $CI_COMMIT_TAG

set-github-origin:
  stage: prune-remote
  before_script:
    - rm -rf .git
  script:
    - git init
    - git remote add origin ${GITHUB_URL}

update-remote:
  stage: update-remote
  needs: 
    - set-github-origin
  script:
    - git add . -- ':!.gitlab-ci.yml'
  when: manual